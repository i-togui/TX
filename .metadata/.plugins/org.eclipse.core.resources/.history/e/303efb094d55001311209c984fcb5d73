package core;

import java.io.File;
import java.io.FileDescriptor;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import android.media.MediaRecorder;
import android.os.Environment;
import android.util.Log;

public class Mp3Recorder 
{
	MediaRecorder recorder = new MediaRecorder();
	long startTime;
	long duration;
	Mp3Recorder()
	{
		try 
		{
		recorder.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
		recorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
		File folder = new File(Environment.getExternalStorageDirectory()
		            + File.separator + "Audio recordings");
		String[] files = folder.list();

		int number = files.length + 1;
		    String filename = "AudioSample" + number + ".mp3";
		    File output = new File(Environment.getExternalStorageDirectory()
		            + File.separator + "Audio recordings" + File.separator
		            + filename);
		    FileOutputStream writer = new FileOutputStream(output);
			
		    FileDescriptor fd = writer.getFD();
		    recorder.setOutputFile(fd);
		        

		   
		} 
		catch (FileNotFoundException e1) 
		{
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
		catch (IllegalStateException e) 
		{
		        e.printStackTrace();
		} 
		catch (IOException e) 
		{
		        Log.e("stuff", "prepare() failed");
		        e.printStackTrace();
		}
	}
	
	
	public void start()
	{
	    try 
	    {
			recorder.prepare();
			recorder.start();
		    startTime = System.nanoTime();
		    duration = 0;
	    } 
	    catch (IllegalStateException e) 
	    {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} 
	    catch (IOException e) 
	    {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	    
	}
}
