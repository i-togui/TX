package core;

import java.io.File;
import java.io.FileDescriptor;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import android.media.MediaRecorder;
import android.os.Environment;
import android.util.Log;

public class Mp3Recorder 
{
	MediaRecorder recorder = new MediaRecorder();
	long startTime;
	Mp3Recorder()
	{
		try 
		{
			recorder.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
			recorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
			File output = new File();
			FileOutputStream writer = new FileOutputStream(output);
			FileDescriptor fd = writer.getFD();
			recorder.setOutputFile(fd);		   
		} 
		catch (FileNotFoundException e1) 
		{
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
		catch (IllegalStateException e) 
		{
		        e.printStackTrace();
		} 
		catch (IOException e) 
		{
		        Log.e("stuff", "prepare() failed");
		        e.printStackTrace();
		}
	}
	
	
	public void start()
	{
	    try 
	    {
			recorder.prepare();
			recorder.start();
		    startTime = System.nanoTime();
	    } 
	    catch (IllegalStateException e) 
	    {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} 
	    catch (IOException e) 
	    {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	    
	}
	public void stop()
	{
	    try 
	    {
	    	if (recorder != null) 
	    	{
	    		recorder.stop();
	    		recorder.release();
	    		recorder = null;
	    	}

	    } 
	    catch (IllegalStateException e) 
	    {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} 
	   
	    
	}
	public long getOffset()
	{
		return System.nanoTime() - startTime;
	}
}
