package com.example.mmrecorder_components;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.StringWriter;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.xmlpull.v1.XmlSerializer;

import android.os.Bundle;
import android.provider.DocumentsContract.Document;
import android.app.Activity;
import android.util.Log;
import android.util.Xml;
import android.view.Menu;

public class XMLActivity extends Activity {

	@Override
	protected void onCreate(Bundle savedInstanceState) 
	{
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_xml);
	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) 
	{
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.xml, menu);
		return true;
	}
	public void addNode()
	{
		
		try {
			File newxmlfile = new File("/mnt/sdcard/new.xml");
			Document doc = null;
	        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
	        try {
	 
	            DocumentBuilder db = dbf.newDocumentBuilder();
	 
	            InputSource is = new InputSource();
	            is.setCharacterStream(new StringReader(xml));
	            doc = db.parse(is); 
	 
	            } catch (ParserConfigurationException e) {
	                Log.e("Error: ", e.getMessage());
	                return null;
	            } catch (SAXException e) {
	                Log.e("Error: ", e.getMessage());
	                return null;
	            } catch (IOException e) {
	                Log.e("Error: ", e.getMessage());
	                return null;
	            }
	                // return DOM
	            return doc;
		
		
		
		
			} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	public void rmNode()
	{}
	public void alterNode()
	{}
	public void createXML()
	{
		File newxmlfile = new File("/mnt/sdcard/new.xml");
		try{
	            newxmlfile.createNewFile();
	        }catch(IOException e)
	        {
	            Log.e("IOException", "Exception in create new File(");
	        }
	        FileOutputStream fileos = null;
	        try{
	            fileos = new FileOutputStream(newxmlfile);

	        }catch(FileNotFoundException e)
	        {
	            Log.e("FileNotFoundException",e.toString());
	        }
	        try {
				writeUsingXMLSerializer(fileos);
				fileos.close();
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
	        
	}
	public static void writeUsingXMLSerializer(FileOutputStream writer) throws Exception {
	    XmlSerializer xmlSerializer = Xml.newSerializer();
	  
	    xmlSerializer.setOutput(writer, "UTF-8");
	    // start DOCUMENT
	    xmlSerializer.startDocument("UTF-8", true);
	    // open tag: <record>
	    xmlSerializer.startTag("", "meeting");
	    // open tag: <study>
	    xmlSerializer.startTag("", "node1");
	    xmlSerializer.attribute("", "param1", "10");
	    xmlSerializer.endTag("", "node1");
	    // open tag: <topic>
	    
	    xmlSerializer.startTag("", "node2");
	    xmlSerializer.text("Du Text!");
	    xmlSerializer.endTag("", "node2");
	    
	    
	    xmlSerializer.endTag("", "meeting");
	    
	    
	    // end DOCUMENT
	    xmlSerializer.endDocument();
	    xmlSerializer.flush();
	}
}
